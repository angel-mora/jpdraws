{"ast":null,"code":"var _jsxFileName = \"/Users/karina/Desktop/projects/jpdraws/client/src/App.js\";\nimport React from 'react';\nimport './App.css';\nimport HomePage from './client/containers/HomePage';\nimport DisplayCart from './client/containers/DisplayCart';\nimport DisplayDrawing from './client/containers/DisplayDrawing';\nimport drawings from './drawings';\nimport Login from './client/containers/Login';\nimport { Route, Switch, Redirect, withRouter } from 'react-router-dom';\nimport Signup from './client/containers/Signup';\nimport OrderHistory from './client/components/OrderHistory';\nconst DEFAULT_STATE = {\n  token: null,\n  user_id: '',\n  user: null,\n  drawings: drawings,\n  specs: null,\n  cart: [],\n  error: false\n};\n\nclass App extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = DEFAULT_STATE;\n\n    this.specsMethod = drawing => {\n      this.setState({\n        specs: drawing\n      });\n    };\n\n    this.addToCart = (drawing, material) => {\n      this.setState({\n        cart: [...this.state.cart, drawing],\n        specs: null\n      });\n    };\n\n    this.resetSpecs = () => {\n      this.setState({\n        specs: null\n      });\n    };\n\n    this.getToken = event => {\n      let username = event.target.username.value;\n      let password = event.target.password.value;\n      console.log(\"EVENT\", username, password);\n      return fetch(\"http://localhost:3000/login\", {\n        method: \"POST\",\n        headers: {\n          \"Content-type\": \"application/json\",\n          \"Accept\": \"application/json\"\n        },\n        body: JSON.stringify({\n          username,\n          password\n        })\n      }).then(r => r.json()).then(data => {\n        console.log(\"data\", data);\n\n        if (data.errors) {\n          this.setState({\n            error: true\n          });\n        } else {\n          localStorage.token = data.token;\n          localStorage.user_id = data.user_id;\n          this.setState({\n            token: data.token,\n            user_id: data.user_id\n          });\n        }\n      });\n    };\n\n    this.totalAmount = cart => {\n      if (cart.length === 0) return 0;\n      let prices = cart.map(item => {\n        return item.price;\n      });\n      let total = prices.reduce((total, num) => {\n        return total + num;\n      });\n      return total;\n    };\n\n    this.getUser = () => {\n      return fetch(`http://localhost:3000/users/${this.state.user_id}`, {\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json',\n          'Authorization': this.state.token\n        }\n      }).then(res => res.json()).then(user => {\n        localStorage.setItem('user', JSON.stringify(user));\n        this.setState({\n          user,\n          drawings\n        });\n      });\n    };\n\n    this.fetchUser = event => {\n      event.preventDefault();\n      this.getToken(event).then(() => {\n        this.getUser();\n      });\n    };\n\n    this.newUser = event => {\n      let username = event.target.username.value;\n      let password = event.target.password.value;\n      return fetch(\"http://localhost:3000/users\", {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify({\n          first_name: event.target.first_name.value,\n          last_name: event.target.last_name.value,\n          username,\n          password\n        })\n      }).then(r => r.json()).then(data => {\n        this.setState({\n          username,\n          password\n        }); // console.log(data, \"data\")\n\n        this.fetchUser(event);\n      });\n    };\n\n    this.createUser = event => {\n      event.preventDefault();\n      this.newUser(event).then(this.getToken()).then(() => {\n        this.getUser();\n      });\n    };\n\n    this.logOut = () => {\n      localStorage.token = null;\n      localStorage.user_id = null;\n      localStorage.user = null;\n      this.setState(DEFAULT_STATE);\n    };\n\n    this.removeFromCart = item => {\n      let newCart = this.state.cart.filter(data => {\n        return data !== item;\n      });\n      this.setState({\n        cart: newCart\n      });\n    };\n  }\n\n  componentDidMount() {\n    let user = JSON.parse(localStorage.getItem('user'));\n\n    if (localStorage.token) {\n      this.setState({\n        token: localStorage.token,\n        user_id: localStorage.user_id,\n        user\n      });\n    }\n  }\n\n  render() {\n    localStorage.setItem('cart', JSON.stringify(this.state.cart));\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      render: props => React.createElement(HomePage, {\n        resetSpecs: this.resetSpecs,\n        specs: this.state.specs,\n        specsMethod: this.specsMethod,\n        logOut: this.logOut,\n        user: this.state.user,\n        drawings: this.state.drawings,\n        cart: this.state.cart,\n        addToCart: this.addToCart,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/cart\",\n      render: props => React.createElement(DisplayCart, {\n        resetSpecs: this.resetSpecs,\n        specs: this.state.specs,\n        specsMethod: this.specsMethod,\n        logOut: this.logOut,\n        user: this.state.user,\n        drawings: this.state.drawings,\n        cart: this.state.cart,\n        addToCart: this.addToCart,\n        loginAttempt: this.loginAttempt,\n        fetchUser: this.fetchUser,\n        totalAmount: this.totalAmount,\n        getUser: this.getUser,\n        removeFromCart: this.removeFromCart,\n        error: this.state.error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/drawing\",\n      render: props => React.createElement(DisplayDrawing, {\n        resetSpecs: this.resetSpecs,\n        specs: this.state.specs,\n        specsMethod: this.specsMethod,\n        logOut: this.logOut,\n        user: this.state.user,\n        drawings: this.state.drawings,\n        cart: this.state.cart,\n        addToCart: this.addToCart,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/signup\",\n      render: props => React.createElement(Signup, {\n        createUser: this.createUser,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/login\",\n      render: props => React.createElement(Login, {\n        loginAttempt: this.loginAttempt,\n        fetchUser: this.fetchUser,\n        error: this.state.error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/orderhistory\",\n      render: props => React.createElement(OrderHistory, {\n        resetSpecs: this.resetSpecs,\n        specs: this.state.specs,\n        specsMethod: this.specsMethod,\n        logOut: this.logOut,\n        user: this.state.user,\n        drawings: this.state.drawings,\n        cart: this.state.cart,\n        addToCart: this.addToCart,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }), \"} />\", React.createElement(Redirect, {\n      to: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    })), this.state.user ? React.createElement(Redirect, {\n      to: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }) : null, this.state.specs ? React.createElement(Redirect, {\n      to: \"drawing\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }) : React.createElement(Redirect, {\n      to: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default withRouter(App);","map":{"version":3,"sources":["/Users/karina/Desktop/projects/jpdraws/client/src/App.js"],"names":["React","HomePage","DisplayCart","DisplayDrawing","drawings","Login","Route","Switch","Redirect","withRouter","Signup","OrderHistory","DEFAULT_STATE","token","user_id","user","specs","cart","error","App","Component","state","specsMethod","drawing","setState","addToCart","material","resetSpecs","getToken","event","username","target","value","password","console","log","fetch","method","headers","body","JSON","stringify","then","r","json","data","errors","localStorage","totalAmount","length","prices","map","item","price","total","reduce","num","getUser","res","setItem","fetchUser","preventDefault","newUser","first_name","last_name","createUser","logOut","removeFromCart","newCart","filter","componentDidMount","parse","getItem","render","props","loginAttempt"],"mappings":"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","sourcesContent":["import React from 'react'\nimport './App.css';\nimport HomePage from './client/containers/HomePage'\nimport DisplayCart from './client/containers/DisplayCart'\nimport DisplayDrawing from './client/containers/DisplayDrawing'\nimport drawings from './drawings'\nimport Login from './client/containers/Login'\nimport {Route, Switch, Redirect, withRouter} from 'react-router-dom'\nimport Signup from './client/containers/Signup'\nimport OrderHistory from './client/components/OrderHistory'\n\nconst DEFAULT_STATE = {\n  token: null,\n  user_id: '',\n  user: null,\n  drawings: drawings,\n  specs: null,\n  cart: [],\n  error: false\n}\n\nclass App extends React.Component {\n  state= DEFAULT_STATE\n\n  componentDidMount(){\n    let user = JSON.parse(localStorage.getItem('user'))\n    if (localStorage.token){\n      this.setState({\n        token: localStorage.token,\n        user_id: localStorage.user_id,\n        user\n      })\n    }\n  }\n\n  specsMethod = (drawing) => {\n    this.setState({\n      specs: drawing\n    })\n  }\n\n  addToCart = (drawing, material) => {\n    this.setState({\n      cart: [...this.state.cart, drawing],\n      specs: null\n    })\n  }\n\n  resetSpecs = () => {\n    this.setState({\n      specs: null\n    })\n  }\n\n  getToken = (event) => {\n    let username = event.target.username.value\n    let password = event.target.password.value\n    console.log(\"EVENT\", username, password)\n    return fetch(\"http://localhost:3000/login\", {\n      method: \"POST\",\n      headers: {\n        \"Content-type\": \"application/json\",\n        \"Accept\": \"application/json\"\n      },\n      body: JSON.stringify({\n        username,\n        password\n      })\n    })\n      .then(r => r.json())\n      .then(data => {\n        console.log(\"data\", data)\n        if (data.errors) {\n          this.setState({\n            error: true\n          })\n        } else {\n          localStorage.token = data.token\n          localStorage.user_id = data.user_id\n          this.setState({\n            token: data.token,\n            user_id: data.user_id\n          })\n        }\n      })\n  }\n\n  totalAmount = (cart) => {\n    if (cart.length === 0) return 0\n\n    let prices = cart.map((item) => {return item.price})\n    let total = prices.reduce((total, num) => {return total + num})\n    return total\n  }\n\n  getUser = () => {\n    return fetch(`http://localhost:3000/users/${this.state.user_id}`, {\n    headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n        'Authorization': this.state.token\n      }\n    })\n    .then(res => res.json())\n    .then(user => {\n      localStorage.setItem('user', JSON.stringify(user))\n      this.setState({\n        user,\n        drawings\n      })\n    })\n  }\n\n  fetchUser = (event) => {\n    event.preventDefault()\n    this.getToken(event)\n      .then(() => {\n        this.getUser()\n    })\n  }\n\n  newUser = (event) => {\n    let username = event.target.username.value\n    let password = event.target.password.value\n    return fetch(\"http://localhost:3000/users\", {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      body: JSON.stringify({\n        first_name: event.target.first_name.value,\n        last_name:event.target.last_name.value,\n        username,\n        password\n      })\n    })\n    .then(r => r.json())\n    .then(data => {\n      this.setState({\n        username,\n        password\n      })\n      // console.log(data, \"data\")\n      this.fetchUser(event)\n    })\n  }\n\n  createUser = (event) => {\n    event.preventDefault()\n    this.newUser(event)\n    .then(\n    this.getToken())\n      .then(() => {\n        this.getUser()\n    })\n  }\n\n  logOut = () => {\n    localStorage.token = null\n    localStorage.user_id = null\n    localStorage.user = null\n    this.setState(\n      DEFAULT_STATE\n    )\n  }\n\n  removeFromCart = (item) => {\n    let newCart = this.state.cart.filter(data => {\n      return data !== item\n    })\n    this.setState({\n      cart: newCart\n    })\n  }\n\n  render() {\n    localStorage.setItem('cart', JSON.stringify(this.state.cart))\n\n    return (\n        <div className=\"App\">\n          <Switch>\n            <Route exact path='/' render={(props) => <HomePage resetSpecs={this.resetSpecs} specs={this.state.specs} specsMethod={this.specsMethod} logOut={this.logOut} user={this.state.user} drawings={this.state.drawings} cart={this.state.cart} addToCart={this.addToCart}/>} />\n\n            <Route path='/cart' render={(props) => <DisplayCart resetSpecs={this.resetSpecs} specs={this.state.specs} specsMethod={this.specsMethod} logOut={this.logOut} user={this.state.user} drawings={this.state.drawings} cart={this.state.cart} addToCart={this.addToCart} loginAttempt={this.loginAttempt} fetchUser={this.fetchUser} totalAmount={this.totalAmount} getUser={this.getUser} removeFromCart={this.removeFromCart} error={this.state.error} />} />\n\n            <Route path='/drawing' render={(props) => <DisplayDrawing resetSpecs={this.resetSpecs} specs={this.state.specs} specsMethod={this.specsMethod} logOut={this.logOut} user={this.state.user} drawings={this.state.drawings} cart={this.state.cart} addToCart={this.addToCart} />} />\n\n            <Route path='/signup' render={(props) => <Signup createUser={ this.createUser }/>} />\n\n            <Route path='/login' render={(props) => <Login loginAttempt={this.loginAttempt} fetchUser={this.fetchUser}\n            error={this.state.error} />} />\n\n            <Route path='/orderhistory' render={(props) => <OrderHistory resetSpecs={this.resetSpecs} specs={this.state.specs} specsMethod={this.specsMethod} logOut={this.logOut} user={this.state.user} drawings={this.state.drawings} cart={this.state.cart} addToCart={this.addToCart}/>} />} />\n\n            <Redirect to='' />\n          </Switch>\n\n\n\n           {this.state.user ?\n           <Redirect to='' />\n            :\n            null\n            }\n\n          { this.state.specs ?\n            <Redirect to='drawing' />\n            :\n            <Redirect to='' />\n           }\n\n      </div>\n    )\n  }\n}\n\nexport default withRouter(App)\n"]},"metadata":{},"sourceType":"module"}